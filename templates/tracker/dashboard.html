{% extends "base.html" %}
{% block content %}
<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
  <div class="lg:col-span-2 space-y-4">
    <div class="card">
      <h2 class="text-lg font-semibold">Overview</h2>
      <div class="grid grid-cols-2 gap-4 mt-4">
        <div class="p-4 bg-slate-50 rounded">
          <div class="text-sm text-slate-500">Notes</div>
          <div class="text-2xl font-bold">{{ stats.notes }}</div>
        </div>
        <div class="p-4 bg-slate-50 rounded">
          <div class="text-sm text-slate-500">Projects</div>
          <div class="text-2xl font-bold">{{ stats.projects }}</div>
        </div>
        <div class="p-4 bg-slate-50 rounded">
          <div class="text-sm text-slate-500">Tasks</div>
          <div class="text-2xl font-bold">{{ stats.tasks }}</div>
        </div>
        <div class="p-4 bg-slate-50 rounded">
          <div class="text-sm text-slate-500">Done</div>
          <div class="text-2xl font-bold">{{ stats.done_tasks }}</div>
        </div>
      </div>
    </div>

    <div class="card">
      <h3 class="font-semibold">Recent Notes</h3>
      <div class="mt-3 space-y-3">
        {% for note in notes %}
          <div class="p-3 bg-white dark:bg-slate-800 rounded">
            <div class="flex justify-between">
              <div>
                <div class="font-medium">{{ note.title }}</div>
                <div class="text-sm text-slate-500">{{ note.content|truncatechars:140 }}</div>
              </div>
              <div class="text-xs text-slate-400">{{ note.updated_at|date:"M d" }}</div>
            </div>
          </div>
        {% empty %}
          <div class="text-slate-500">No notes yet.</div>
        {% endfor %}
      </div>
    </div>

    <div class="card">
      <h3 class="font-semibold">Milestones</h3>
      <div class="mt-3 space-y-2">
        {% for m in milestones %}
          <div class="p-3 bg-white dark:bg-slate-800 rounded flex justify-between">
            <div>
              <div class="font-medium">{{ m.title }}</div>
              <div class="text-sm text-slate-500">{{ m.description }}</div>
            </div>
            <div class="text-xs text-slate-400">{{ m.date }}</div>
          </div>
        {% empty %}
          <div class="text-slate-500">No milestones yet.</div>
        {% endfor %}
      </div>
    </div>
  </div>

  <aside class="space-y-4">
    <div class="card">
      <h3 class="font-semibold">Active Project</h3>
      {% with p=projects.first %}
        {% if p %}
          <div class="mt-3">
            <div class="font-medium">{{ p.title }}</div>
            <div class="text-sm text-slate-500">{{ p.description|truncatechars:120 }}</div>
            <div class="mt-3">
              <div class="w-full h-2 bg-slate-200 rounded">
                <div style="width:{{ p.progress }}%" class="h-full bg-sky-300"></div>
              </div>
              <div class="text-xs text-slate-500 mt-1">{{ p.progress }}%</div>
            </div>
          </div>
        {% else %}
          <div class="text-slate-500 mt-2">No active project yet.</div>
        {% endif %}
      {% endwith %}
    </div>

    <div class="card">
      <h3 class="font-semibold">Weekly Activity</h3>
      <div class="mt-3">
        {% for d in week %}
          <div class="flex items-center justify-between text-sm mt-2">
            <div>{{ d.day }}</div>
            <div class="text-slate-500">{{ d.value }} tasks</div>
          </div>
        {% endfor %}
      </div>
    </div>
  </aside>
</div>
{% endblock %}